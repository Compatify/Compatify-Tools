<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compatify</title>
    <!-- Favicon using an inline SVG -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%231d4ed8' d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E">
    <!-- Use Tailwind CSS for a professional, responsive design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font for a clean, modern look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Use a simple Markdown parser to format the AI's analysis -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.12/marked.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* Lighter background for a cleaner feel */
        }
        /* Custom styles for the loading animation */
        .loading-animation {
            border: 4px solid #e2e8f0;
            border-top: 4px solid #1d4ed8; /* Darker blue for contrast */
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Custom accordion styles for the FAQ */
        .accordion-item {
            border-bottom: 1px solid #e2e8f0;
        }
        .accordion-button {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 1.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #1a202c;
            background-color: #fff;
            transition: background-color 0.2s ease-in-out;
            border: none;
        }
        .accordion-button:hover {
            background-color: #f7fafc;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
            padding: 0 1.5rem;
            background-color: #f7fafc;
        }
        .accordion-content.active {
            max-height: 500px; /* A large enough value to handle content */
            padding: 1.5rem;
        }
        .active-link {
            color: #1d4ed8; /* Blue for the active link */
            font-weight: 700;
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col items-center justify-between min-h-screen">

    <!-- Top Navigation -->
    <nav class="w-full bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo & Site Title -->
                <div class="flex-shrink-0 flex items-center">
                    <svg class="w-8 h-8 text-blue-700" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <span class="ml-2 text-2xl font-bold text-gray-900">Compatify</span>
                    <span class="ml-1 text-sm text-blue-500 font-semibold">Tools</span>
                </div>
                <!-- Navigation Links -->
                <div class="flex space-x-8">
                    <button id="nav-home" class="text-gray-600 hover:text-blue-600 transition-colors duration-200 font-medium active-link">Home</button>
                    <button id="nav-how-it-works" class="text-gray-600 hover:text-blue-600 transition-colors duration-200 font-medium">How it Works</button>
                    <button id="nav-about-us" class="text-gray-600 hover:text-blue-600 transition-colors duration-200 font-medium">About Us</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Container -->
    <div class="w-full flex-grow flex flex-col items-center justify-center p-4">
        <!-- Main Application Container - Home Page -->
        <main id="home-page" class="w-full max-w-4xl mx-auto bg-white rounded-3xl shadow-xl overflow-hidden p-6 md:p-10 transition-transform duration-300">

            <!-- Header Section with Logo -->
            <header class="text-center mb-10">
                <h1 class="text-3xl md:text-4xl text-gray-900 font-bold mb-3 tracking-tight">Stop Guessing. Start Connecting.</h1>
                <p class="text-lg text-gray-500">Check any devices, cables, or accessories for compatibility and get product suggestions that actually work</p>
            </header>

            <!-- Input Form Section -->
            <section class="mb-6">
                <!-- Container for dynamic input fields and the add button -->
                <div id="input-container" class="flex flex-col sm:flex-row gap-4 flex-wrap items-center">
                    <input type="text" id="itemA" placeholder="e.g., MacBook Pro"
                           class="flex-1 p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all duration-200 text-gray-700">
                    <input type="text" id="itemB" placeholder="e.g., HDMI Cord"
                           class="flex-1 p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all duration-200 text-gray-700">
                    <!-- Plus sign button to add new input fields -->
                    <button id="addDeviceBtn" title="Add another device"
                            class="p-4 bg-blue-100 text-blue-600 rounded-xl shadow-lg hover:bg-blue-200 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-blue-200 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256" class="w-6 h-6"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12h-80v80a12 12 0 0 1-24 0v-80H40a12 12 0 0 1 0-24h80V40a12 12 0 0 1 24 0v80h80a12 12 0 0 1 12 12Z"/></svg>
                    </button>
                </div>
                <div class="flex justify-center mt-6">
                    <button id="analyzeBtn"
                            class="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-bold text-xl rounded-xl shadow-lg hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-blue-200">
                        Run Check
                    </button>
                </div>
            </section>

            <!-- "Try It Out" Section (Simplified) -->
            <section class="text-center mb-10">
                <div class="flex flex-wrap justify-center gap-2 md:gap-4">
                    <button class="try-example bg-gray-100 text-gray-700 text-sm md:text-base font-medium px-4 py-2 rounded-full hover:bg-gray-200 transition-colors"
                            data-item-a="iPhone 16 Pro" data-item-b="Bluetooth Headphones">Try: iPhone 16 Pro & Bluetooth Headphones</button>
                    <button class="try-example bg-gray-100 text-gray-700 text-sm md:text-base font-medium px-4 py-2 rounded-full hover:bg-gray-200 transition-colors"
                            data-item-a="Dell XPS 15" data-item-b="Monitor with HDMI">Try: Dell XPS 15 & HDMI Monitor</button>
                    <button class="try-example bg-gray-100 text-gray-700 text-sm md:text-base font-medium px-4 py-2 rounded-full hover:bg-gray-200 transition-colors"
                            data-item-a="PlayStation 5" data-item-b="4K TV">Try: PlayStation 5 & 4K TV</button>
                </div>
            </section>

            <!-- Results Section Container (Hidden by default) -->
            <section id="resultsDiv" class="hidden">
                <div class="space-y-8">
                    <!-- Compatibility Analysis Card -->
                    <div class="bg-blue-50 p-6 rounded-2xl shadow-inner border border-blue-200">
                        <h2 class="text-3xl font-bold text-blue-900 mb-4 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="text-blue-600 mr-2 w-8 h-8" viewBox="0 0 256 256"><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m46.12 73.88a12 12 0 0 1-17 17l-35.12-35.13a12 12 0 0 1 17-17Zm-52 64a12 12 0 0 1-17 17L87 142.06a12 12 0 0 1 17-17l12.12 12.12a12 12 0 0 1-2.12 17l-10.12 10.13Z"/></svg>
                            Compatibility Analysis
                        </h2>
                        
                        <!-- New section for clear status and summary -->
                        <div class="mb-4 p-4 rounded-xl border-2 bg-white">
                            <h3 id="compatibilityStatus" class="text-2xl font-bold mb-2"></h3>
                            <p id="compatibilitySummary" class="text-gray-700"></p>
                        </div>

                        <!-- Original detailed analysis content -->
                        <div id="analysisContent" class="prose max-w-none text-gray-700 leading-relaxed">
                            <!-- Detailed analysis content will be injected here as formatted Markdown -->
                        </div>
                    </div>

                    <!-- Affiliate Product Card (Hidden by default) -->
                    <div id="affiliateProductDiv" class="hidden bg-white p-6 rounded-2xl shadow-xl border border-gray-200 transform transition-transform duration-300 hover:scale-[1.01]">
                        <div class="flex flex-col sm:flex-row items-center gap-6">
                            <div class="w-full sm:w-auto flex-shrink-0">
                                <img id="productImage" src="https://placehold.co/128x128/E2E8F0/1A202C?text=No+Image" alt="Recommended Product"
                                     class="w-32 h-32 object-contain rounded-xl border border-gray-200 p-2 transition-transform duration-200 hover:scale-105">
                            </div>
                            <div class="flex-1 text-center sm:text-left">
                                <!-- Title will change based on compatibility status -->
                                <h3 id="productRecommendationTitle" class="text-2xl font-bold text-gray-900 mb-1">Recommended Product</h3>
                                <h4 id="productName" class="text-lg font-semibold text-gray-800">Product Name Placeholder</h4>
                                <p id="productDescription" class="text-gray-500 mt-2 text-sm leading-relaxed">Product description will appear here.</p>
                                <a id="affiliateLink" href="#" target="_blank" rel="noopener noreferrer"
                                   class="mt-4 inline-block bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                                    View on Amazon
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Social Sharing Section -->
                    <div id="shareDiv" class="flex flex-col items-center justify-center mt-8 p-6 bg-gray-50 rounded-2xl border border-gray-200">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Share Your Analysis</h3>
                        <div class="flex space-x-4">
                            <!-- Removed social media buttons as requested -->
                            <button id="share-copy" class="share-button p-3 bg-gray-300 text-gray-800 rounded-full hover:bg-gray-400 transition-colors shadow-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 256 256"><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m52 108a4 4 0 0 1-4 4H84a4 4 0 0 1-4-4a4 4 0 0 1 4-4h92a4 4 0 0 1 4 4Zm-16 44a4 4 0 0 1-4 4h-60a4 4 0 0 1 0-8h60a4 4 0 0 1 4 4Zm12-88a4 4 0 0 1-4 4h-84a4 4 0 0 1 0-8h84a4 4 0 0 1 4 4Zm-16-16a4 4 0 0 1-4 4h-60a4 4 0 0 1 0-8h60a4 4 0 0 1 4 4Z"/></svg>
                            </button>
                        </div>
                        <div id="share-message" class="text-sm text-green-700 mt-2 hidden">Link copied to clipboard!</div>
                    </div>
                </div>
            </section>

            <!-- Loading Indicator -->
            <div id="loading" class="flex flex-col items-center justify-center mt-8 space-y-3 hidden">
                <div class="loading-animation"></div>
                <span id="loading-message" class="text-lg text-gray-600 font-medium">Analyzing compatibility...</span>
            </div>

            <!-- Error Message Box -->
            <div id="errorBox" class="mt-8 p-4 bg-red-50 text-red-700 border border-red-200 rounded-xl shadow-sm hidden">
                <strong class="font-semibold">Oh no! An error occurred:</strong>
                <span id="errorMessage"></span>
            </div>
        </main>

        <!-- How It Works Page -->
        <section id="how-it-works-page" class="w-full max-w-4xl mx-auto bg-white rounded-3xl shadow-xl overflow-hidden p-8 md:p-12 hidden transition-transform duration-300">
            <h2 class="text-4xl font-bold text-gray-900 mb-6 text-center">How It Works</h2>
            <div class="space-y-10">
                <div class="flex flex-col md:flex-row items-center gap-8">
                    <div class="bg-blue-100 text-blue-600 rounded-full w-16 h-16 flex items-center justify-center flex-shrink-0 text-3xl font-bold">1</div>
                    <div class="text-center md:text-left">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Input Your Items</h3>
                        <p class="text-gray-600">Simply enter the two tech items you want to check for compatibility, such as a "MacBook Pro M3" and a "USB-C Hub." Our system understands natural language, so there's no need for complex codes or part numbers.</p>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row items-center gap-8">
                    <div class="bg-blue-100 text-blue-600 rounded-full w-16 h-16 flex items-center justify-center flex-shrink-0 text-3xl font-bold">2</div>
                    <div class="text-center md:text-left">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Get an Instant Analysis</h3>
                        <p class="text-gray-600">Powered by advanced AI, Compatify instantly analyzes the specifications and interfaces of your items. You'll receive a detailed, easy-to-understand breakdown of whether they are compatible and what to look out for.</p>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row items-center gap-8">
                    <div class="bg-blue-100 text-blue-600 rounded-full w-16 h-16 flex items-center justify-center flex-shrink-0 text-3xl font-bold">3</div>
                    <div class="text-center md:text-left">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Find a Perfect Solution</h3>
                        <p class="text-gray-600">If a problem is found, our system will intelligently suggest a compatible product from our curated list. We provide a direct link to the product on a trusted retailer, saving you time and money.</p>
                    </div>
                </div>
            </div>
            <!-- FAQ Section -->
            <div class="mt-12">
                <h3 class="text-3xl font-bold text-gray-900 mb-6 text-center">Frequently Asked Questions</h3>
                <div class="space-y-4">
                    <div class="accordion-item rounded-xl overflow-hidden shadow-sm border border-gray-200">
                        <button class="accordion-button">
                            <span>How accurate is the compatibility check?</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ph-plus text-lg accordion-icon w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12h-80v80a12 12 0 0 1-24 0v-80H40a12 12 0 0 1 0-24h80V40a12 12 0 0 1 24 0v80h80a12 12 0 0 1 12 12Z"/></svg>
                        </button>
                        <div class="accordion-content">
                            <p class="text-gray-600 leading-relaxed">Our AI model is trained on a vast amount of technical data to provide highly accurate analyses. However, we always recommend double-checking the product specifications before making a purchase, as new products are released daily.</p>
                        </div>
                    </div>
                    <div class="accordion-item rounded-xl overflow-hidden shadow-sm border border-gray-200">
                        <button class="accordion-button">
                            <span>Is this service free to use?</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ph-plus text-lg accordion-icon w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12h-80v80a12 12 0 0 1-24 0v-80H40a12 12 0 0 1 0-24h80V40a12 12 0 0 1 24 0v80h80a12 12 0 0 1 12 12Z"/></svg>
                        </button>
                        <div class="accordion-content">
                            <p class="text-gray-600 leading-relaxed">Yes, Compatify is a completely free service. We are supported by the affiliate links you see in the product recommendations. There is no cost to you to use the compatibility checker.</p>
                        </div>
                    </div>
                    <div class="accordion-item rounded-xl overflow-hidden shadow-sm border border-gray-200">
                        <button class="accordion-button">
                            <span>What if the analysis is wrong?</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ph-plus text-lg accordion-icon w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12h-80v80a12 12 0 0 1-24 0v-80H40a12 12 0 0 1 0-24h80V40a12 12 0 0 1 24 0v80h80a12 12 0 0 1 12 12Z"/></svg>
                        </button>
                        <div class="accordion-content">
                            <p class="text-gray-600 leading-relaxed">Our AI model is highly accurate, but it's not perfect. Technology is constantly changing, and new products are released frequently. If you believe the analysis is incorrect, please feel free to send us feedback. We recommend always double-checking product specifications before making a final purchase.</p>
                        </div>
                    </div>
                    <div class="accordion-item rounded-xl overflow-hidden shadow-sm border border-gray-200">
                        <button class="accordion-button">
                            <span>Why are there affiliate links?</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ph-plus text-lg accordion-icon w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12h-80v80a12 12 0 0 1-24 0v-80H40a12 12 0 0 1 0-24h80V40a12 12 0 0 1 24 0v80h80a12 12 0 0 1 12 12Z"/></svg>
                        </button>
                        <div class="accordion-content">
                            <p class="text-gray-600 leading-relaxed">The affiliate links help support this free service. When you make a purchase through one of our links, we may earn a small commission at no extra cost to you. This allows us to keep the site running and continue to improve the service for everyone.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Page (Hidden by default) -->
        <section id="about-us-page" class="w-full max-w-4xl mx-auto bg-white rounded-3xl shadow-xl overflow-hidden p-8 md:p-12 hidden transition-transform duration-300">
            <!-- Hero Section -->
            <div class="text-center mb-12">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-4">Our Story</h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto"><strong>Welcome to Compatify — where simplicity meets smart technology.</strong> We're a team of developers and tech enthusiasts committed to solving real-world problems.</p>
            </div>

            <!-- Mission Statement Section -->
            <div class="bg-blue-50 p-8 rounded-2xl shadow-inner border border-blue-200 mb-12 text-center">
                <div class="inline-flex p-3 bg-blue-200 text-blue-700 rounded-full mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M168 224a8 8 0 0 1-8 8a104 104 0 0 1-104-104a8 8 0 0 1 16 0a88 88 0 0 0 88 88a8 8 0 0 1 8 8Z"/><path fill="currentColor" d="M224 88a8 8 0 0 0-8-8H40a8 8 0 0 0 0 16h176a8 8 0 0 0 8-8Z"/><path fill="currentColor" d="M224 168a8 8 0 0 0-8 8a88.1 88.1 0 0 1-88 88a8 8 0 0 0 0 16a104.1 104.1 0 0 0 104-104a8 8 0 0 0-8-8Z"/><path fill="currentColor" d="M40 88a8 8 0 0 0-8 8a104 104 0 0 0 104 104a8 8 0 0 0 0-16a88.1 88.1 0 0 1-88-88a8 8 0 0 0-8-8Z"/><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m0 200a92 92 0 1 1 92-92a92.1 92.1 0 0 1-92 92Z"/></svg>
                </div>
                <h3 class="text-3xl font-bold text-blue-900 mb-3">Our Mission</h3>
                <p class="text-gray-700 max-w-2xl mx-auto">Our mission is simple: to take the guesswork out of tech purchases. We created Compatify because we know how frustrating it is to buy an accessory, cable, or gadget—only to realize it's not compatible with your device. We believe technology should just work.</p>
            </div>

            <!-- Philosophy Section -->
            <div class="mb-12">
                <h3 class="text-3xl font-bold text-gray-900 mb-8 text-center">Our Philosophy</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 text-center transition-transform hover:scale-105">
                        <div class="inline-flex p-3 bg-gray-200 text-gray-700 rounded-full mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m-3.41 161.43a12 12 0 0 1-17-17l19.5-19.5a44 44 0 0 0-16.71-38.38l-1.39-.75a12 12 0 0 1 9.4-21.4a68 68 0 0 1 29.56 12.33a68 68 0 0 1 12.33 29.55a12 12 0 0 1-21.4 9.4l-1.39-.74a44 44 0 0 0-16.71 38.37l-1.5 1.5a12 12 0 0 1-17 0Z"/></svg>
                        </div>
                        <h4 class="text-xl font-bold text-gray-800 mb-2">Simplicity</h4>
                        <p class="text-gray-600 text-sm">We design tools that are intuitive and easy to use, so you can focus on what matters.</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 text-center transition-transform hover:scale-105">
                        <div class="inline-flex p-3 bg-gray-200 text-gray-700 rounded-full mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m36.71 77.13a12 12 0 0 1-17 17l-43-43a12 12 0 0 1 17-17l43 43Zm-73.42 122.28a12 12 0 0 1-17-17l-43 43a12 12 0 0 1 17 17l43-43Zm13.4-17.5a12 12 0 0 1-17 17l-43-43a12 12 0 0 1 17-17l43 43Z"/></svg>
                        </div>
                        <h4 class="text-xl font-bold text-gray-800 mb-2">Accuracy</h4>
                        <p class="text-gray-600 text-sm">Our AI is trained on vast datasets to provide highly accurate and reliable results.</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 text-center transition-transform hover:scale-105">
                        <div class="inline-flex p-3 bg-gray-200 text-gray-700 rounded-full mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 256 256"><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m52.12 165.73a8 8 0 0 1-10.24 3.73a72 72 0 0 0-111.76 0a8 8 0 0 1-10.24-3.73a96 96 0 1 1 132.24 0ZM128 140a36 36 0 1 1 36-36a36 36 0 0 1-36 36Zm-36-36a36 36 0 0 1 72 0a36 36 0 0 1-72 0Z"/></svg>
                        </div>
                        <h4 class="text-xl font-bold text-gray-800 mb-2">Community</h4>
                        <p class="text-gray-600 text-sm">We're built by tech lovers for tech lovers, and we're always listening to your feedback.</p>
                    </div>
                </div>
            </div>

            <!-- Call to Action Section -->
            <div class="bg-blue-50 p-8 rounded-2xl shadow-inner border border-blue-200 text-center">
                <h3 class="text-3xl font-bold text-blue-900 mb-4">We'd Love to Hear From You</h3>
                <p class="text-gray-700 max-w-2xl mx-auto mb-6">Whether you spotted a bug, have an idea for a new feature, or just want to say hi, your feedback is what helps us grow. Feel free to reach out anytime.</p>
                <a href="mailto:compatifytools@gmail.com" class="inline-flex items-center px-8 py-3 bg-blue-600 text-white font-bold rounded-full shadow-md hover:bg-blue-700 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mr-2" viewBox="0 0 256 256"><path fill="currentColor" d="M224 48H32a16 16 0 0 0-16 16v128a16 16 0 0 0 16 16h192a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16m-8 12.38V64h-18.7l-75.14 75.14a8 8 0 0 1-11.32 0L59.18 64H32v128h192V64.38ZM128 148.64l84.45-84.45a8 8 0 0 1 11.32 11.31L139.31 160a8 8 0 0 1-11.32 0L32.22 75.5a8 8 0 0 1 11.32-11.31Z"/></svg>
                    Send us an email
                </a>
            </div>

            <div class="mt-12 text-center text-gray-600 font-semibold">
                —The CompatifyTools Team
            </div>
        </section>
    </div>

    <!-- Footer Section -->
    <footer class="w-full bg-gray-900 text-gray-400 py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm">
            <p>&copy; 2025 Compatify. All rights reserved.</p>
            <div class="mt-2 space-x-4">
                <a href="#" class="hover:text-blue-500 transition-colors">Privacy Policy</a>
                <a href="#" class="hover:text-blue-500 transition-colors">Terms of Service</a>
            </div>
        </div>
    </footer>

    <!-- The core logic for the application -->
    <script>
        // Use a simple custom Markdown parser for basic formatting of the AI's response.
        const marked = {
            parse(text) {
                let html = text;
                // Headers
                html = html.replace(/^### (.*$)/gim, '<h3 class="text-xl font-bold mt-4 mb-2">$1</h3>');
                html = html.replace(/^## (.*$)/gim, '<h2 class="text-2xl font-bold mt-6 mb-3">$1</h2>');
                html = html.replace(/^# (.*$)/gim, '<h1 class="text-3xl font-bold mt-8 mb-4">$1</h1>');
                // Unordered lists
                html = html.replace(/^\* (.*$)/gim, '<li class="list-disc ml-6">$1</li>');
                if (html.includes('<li>')) {
                    html = `<ul class="list-inside">${html}</ul>`;
                }
                // Bold and Italic
                html = html.replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>');
                html = html.replace(/\*(.*)\*/gim, '<em>$1</em>');
                html = html.replace(/_{2}(.*)_{2}/gim, '<strong>$1</strong>');
                html = html.replace(/_(.*)_/gim, '<em>$1</em>');
                return html;
            }
        };

        // --- DOM Element References ---
        const analyzeBtn = document.getElementById('analyzeBtn');
        const inputContainer = document.getElementById('input-container');
        const resultsDiv = document.getElementById('resultsDiv');
        const compatibilityStatus = document.getElementById('compatibilityStatus');
        const compatibilitySummary = document.getElementById('compatibilitySummary');
        const analysisContentDiv = document.getElementById('analysisContent');
        const affiliateProductDiv = document.getElementById('affiliateProductDiv');
        const productName = document.getElementById('productName');
        const productDescription = document.getElementById('productDescription');
        const productImage = document.getElementById('productImage');
        const affiliateLink = document.getElementById('affiliateLink');
        const loadingDiv = document.getElementById('loading');
        const loadingMessageSpan = document.getElementById('loading-message');
        const errorBoxDiv = document.getElementById('errorBox');
        const errorMessageSpan = document.getElementById('errorMessage');
        const shareDiv = document.getElementById('shareDiv');
        const shareMessageDiv = document.getElementById('share-message');
        const productRecommendationTitle = document.getElementById('productRecommendationTitle');
        const addDeviceBtn = document.getElementById('addDeviceBtn');

        // Page and Navigation elements
        const homePage = document.getElementById('home-page');
        const howItWorksPage = document.getElementById('how-it-works-page');
        const aboutUsPage = document.getElementById('about-us-page');
        const navHome = document.getElementById('nav-home');
        const navHowItWorks = document.getElementById('nav-how-it-works');
        const navAboutUs = document.getElementById('nav-about-us');

        // --- Data and State ---
        let loadingMessages = [
            'Analyzing your request...',
            'Consulting the compatibility database...',
            'Finding the best product recommendation...',
            'Finalizing your report...'
        ];
        let loadingMessageIndex = 0;
        let loadingInterval = null;

        // --- Functions ---

        // Function to load the affiliate products JSON file.
        async function getAffiliateProducts() {
            try {
                // The URL is relative to the root of the deployed app.
                const response = await fetch('affiliate_products.json');
                if (!response.ok) {
                    throw new Error(`Failed to load affiliate products: ${response.statusText}`);
                }
                return await response.json();
            } catch (error) {
                console.error("Error loading affiliate products:", error);
                throw error;
            }
        }

        // Main function to call the API with a detailed prompt and handle the response.
        async function getCompatibilityAnalysis(items, affiliateProducts) {
            const itemsList = items.map(item => `- ${item}`).join('\n');

            const prompt = `
                You are a helpful assistant that analyzes the compatibility of multiple items and suggests a relevant affiliate product from a list.

                User's Items:
                ${itemsList}

                Affiliate Products JSON:
                ${JSON.stringify(affiliateProducts, null, 2)}

                Instructions:
                1.  Analyze the compatibility between all the items.
                2.  Provide a clear, one-word compatibility status: "Compatible" or "Not Compatible".
                3.  Write a very short summary (one sentence) explaining the outcome. If compatible, say "No issues found." or something similar and encouraging. If not compatible, briefly state the core issue.
                4.  Provide a detailed description of the compatibility analysis, including technical details and why the items work or don't work together. This description should be formatted using simple Markdown.
                5.  Based on the items and the detailed analysis, find the most relevant product from the provided "Affiliate Products JSON" list that could solve a potential problem or enhance the user's experience.
                6.  If a relevant product is found, return its "id".
                7.  If no relevant product is found, return "null" for the "recommendedProductId".
                8.  The response MUST be a JSON object with four fields: "status" (string, either "Compatible" or "Not Compatible"), "summary" (string), "details" (string), and "recommendedProductId" (string or null).
                9.  Ensure the "details" is formatted using simple Markdown (headers, lists, bold text) for readability.
            `;

            const payload = {
                contents: [{
                    parts: [{ text: prompt }]
                }],
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "status": { "type": "STRING", "enum": ["Compatible", "Not Compatible"] },
                            "summary": { "type": "STRING" },
                            "details": { "type": "STRING" },
                            "recommendedProductId": { "type": "STRING" }
                        },
                        "propertyOrdering": ["status", "summary", "details", "recommendedProductId"]
                    }
                }
            };

            let attempts = 0;
            const maxRetries = 3;
            const baseDelay = 1000;

            while (attempts < maxRetries) {
                try {
                    const response = await fetch('/api/proxy', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`Proxy error: ${response.statusText}`);
                    }

                    const result = await response.json();
                    if (!result || !result.content) {
                        throw new Error('API response was empty or malformed.');
                    }
                    
                    // Extract JSON from markdown code block if present
                    let jsonText = result.content;
                    const jsonMatch = jsonText.match(/```json\n([\s\S]*?)\n```/);
                    if (jsonMatch && jsonMatch[1]) {
                        jsonText = jsonMatch[1].trim();
                    } else if (jsonText.startsWith('```json') && jsonText.endsWith('```')) {
                        // Handle cases where the JSON is on a single line or has no extra newlines
                        jsonText = jsonText.substring(7, jsonText.length - 3).trim();
                    }
                    
                    const apiResponse = JSON.parse(jsonText);
                    return apiResponse;
                } catch (error) {
                    attempts++;
                    console.error(`Attempt ${attempts} failed:`, error);
                    if (attempts >= maxRetries) {
                        throw new Error('Failed to get a valid response from the API after multiple retries.');
                    }
                    await new Promise(resolve => setTimeout(resolve, baseDelay * Math.pow(2, attempts)));
                }
            }
        }

        // Function to display the correct page and update active navigation link
        function showPage(pageId) {
            homePage.classList.add('hidden');
            howItWorksPage.classList.add('hidden');
            aboutUsPage.classList.add('hidden');

            document.getElementById(pageId).classList.remove('hidden');

            document.querySelectorAll('.active-link').forEach(link => link.classList.remove('active-link'));
            document.getElementById(`nav-${pageId.replace('-page', '')}`).classList.add('active-link');
        }

        // Function to handle clipboard copy
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    shareMessageDiv.textContent = "Link copied to clipboard!";
                    shareMessageDiv.classList.remove('hidden');
                    setTimeout(() => shareMessageDiv.classList.add('hidden'), 3000);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            } else {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    shareMessageDiv.textContent = "Link copied to clipboard!";
                    shareMessageDiv.classList.remove('hidden');
                    setTimeout(() => shareMessageDiv.classList.add('hidden'), 3000);
                } catch (err) {
                    console.error('Fallback: Failed to copy text', err);
                }
                document.body.removeChild(textarea);
            }
        }

        // --- Core Logic for Compatibility Check ---
        const runCompatibilityCheck = async () => {
            // Get all input values and filter out empty ones
            const items = Array.from(inputContainer.querySelectorAll('input[type="text"]'))
                               .map(input => input.value.trim())
                               .filter(value => value !== '');

            // Clear previous results and errors
            compatibilityStatus.textContent = '';
            compatibilitySummary.textContent = '';
            analysisContentDiv.innerHTML = '';
            productName.textContent = '';
            productDescription.textContent = '';
            productImage.src = 'https://placehold.co/128x128/E2E8F0/1A202C?text=No+Image';
            affiliateLink.href = '#';
            resultsDiv.classList.add('hidden');
            affiliateProductDiv.classList.add('hidden');
            errorBoxDiv.classList.add('hidden');
            shareDiv.classList.add('hidden');

            // --- Updated Validation Logic ---
            if (items.length < 2) {
                errorMessageSpan.textContent = "You need at least two devices to run a check.";
                errorBoxDiv.classList.remove('hidden');
                return;
            }
            
            // Show loading animation and disable button
            loadingDiv.classList.remove('hidden');
            analyzeBtn.disabled = true;

            // Start cycling loading messages
            loadingMessageIndex = 0;
            loadingMessageSpan.textContent = loadingMessages[loadingMessageIndex];
            loadingInterval = setInterval(() => {
                loadingMessageIndex = (loadingMessageIndex + 1) % loadingMessages.length;
                loadingMessageSpan.textContent = loadingMessages[loadingMessageIndex];
            }, 3000);

            try {
                // Fetch the affiliate products first
                const affiliateProducts = await getAffiliateProducts();

                // Call the API with the user's input and product data
                const apiResponse = await getCompatibilityAnalysis(items, affiliateProducts);

                // Update the compatibility status and summary
                compatibilityStatus.textContent = apiResponse.status;
                compatibilityStatus.className = 'text-2xl font-bold mb-2'; // Reset classes
                compatibilitySummary.textContent = apiResponse.summary;

                if (apiResponse.status === 'Compatible') {
                    compatibilityStatus.classList.add('text-green-600');
                    productRecommendationTitle.textContent = "Recommended Upgrade";
                } else {
                    compatibilityStatus.classList.add('text-red-600');
                    productRecommendationTitle.textContent = "A Solution for You";
                }
                
                // Format the detailed analysis output with markdown
                const formattedHtml = marked.parse(apiResponse.details);
                analysisContentDiv.innerHTML = formattedHtml;

                let recommendedProduct = null;
                // --- Primary Recommendation Logic (from API) ---
                if (apiResponse.recommendedProductId && apiResponse.recommendedProductId !== "null") {
                    recommendedProduct = affiliateProducts.find(p => p.id === apiResponse.recommendedProductId);
                }

                // --- Fallback Recommendation Logic ---
                if (!recommendedProduct) {
                    const searchKeywords = items.join(' ').toLowerCase().split(' ').filter(word => word.length > 2);
                    recommendedProduct = affiliateProducts.find(product =>
                        product.compatibility_tags.some(tag =>
                            searchKeywords.some(keyword => tag.toLowerCase().includes(keyword))
                        )
                    );
                }

                // --- Display the Product (if found) ---
                if (recommendedProduct) {
                    productName.textContent = recommendedProduct.name;
                    productDescription.textContent = recommendedProduct.description;
                    productImage.src = recommendedProduct.image_url;
                    productImage.alt = recommendedProduct.name;
                    affiliateLink.href = recommendedProduct.affiliate_link;
                    productImage.onerror = () => {
                        productImage.src = `https://placehold.co/128x128/E2E8F0/1A202C?text=No+Image`;
                    };
                    affiliateProductDiv.classList.remove('hidden');
                } else {
                    affiliateProductDiv.classList.add('hidden');
                }
                
                resultsDiv.classList.remove('hidden');
                shareDiv.classList.remove('hidden');

            } catch (error) {
                errorMessageSpan.textContent = error.message;
                errorBoxDiv.classList.remove('hidden');
            } finally {
                // Stop the loading messages and hide the loading animation
                clearInterval(loadingInterval);
                loadingDiv.classList.add('hidden');
                analyzeBtn.disabled = false;
            }
        };

        // --- Event Listeners ---

        // Listeners for page navigation
        navHome.addEventListener('click', () => showPage('home-page'));
        navHowItWorks.addEventListener('click', () => showPage('how-it-works-page'));
        navAboutUs.addEventListener('click', () => showPage('about-us-page'));

        // Listener for "Run Check" button
        analyzeBtn.addEventListener('click', runCompatibilityCheck);
        
        // Listener for "Add Device" button
        addDeviceBtn.addEventListener('click', () => {
            const newItemInput = document.createElement('input');
            newItemInput.type = 'text';
            newItemInput.placeholder = 'e.g., Apple Watch';
            newItemInput.className = 'flex-1 p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all duration-200 text-gray-700';
            
            newItemInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    runCompatibilityCheck();
                }
            });
            
            // Insert the new input field before the add button
            inputContainer.insertBefore(newItemInput, addDeviceBtn);
        });

        // Event listeners for the "Enter" key on the input fields
        // This is now handled dynamically for all new inputs
        document.querySelectorAll('input[type="text"]').forEach(input => {
            input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    runCompatibilityCheck();
                }
            });
        });

        // Listeners for "Try It Out!" examples
        document.querySelectorAll('.try-example').forEach(button => {
            button.addEventListener('click', (e) => {
                const buttonText = e.target.textContent;
                const matches = buttonText.match(/Try: (.*) & (.*)/);
                if (matches && matches.length === 3) {
                    // Clear existing inputs and add new ones
                    inputContainer.innerHTML = `
                        <input type="text" placeholder="e.g., MacBook Pro" class="flex-1 p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all duration-200 text-gray-700" value="${matches[1].trim()}">
                        <input type="text" placeholder="e.g., HDMI Cord" class="flex-1 p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all duration-200 text-gray-700" value="${matches[2].trim()}">
                        <button id="addDeviceBtn" title="Add another device" class="p-4 bg-blue-100 text-blue-600 rounded-xl shadow-lg hover:bg-blue-200 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-blue-200 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256" class="w-6 h-6"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12h-80v80a12 12 0 0 1-24 0v-80H40a12 12 0 0 1 0-24h80V40a12 12 0 0 1 24 0v80h80a12 12 0 0 1 12 12Z"/></svg>
                        </button>
                    `;
                    // Re-attach event listeners after DOM manipulation
                    document.getElementById('addDeviceBtn').addEventListener('click', () => {
                        const newItemInput = document.createElement('input');
                        newItemInput.type = 'text';
                        newItemInput.placeholder = 'e.g., Apple Watch';
                        newItemInput.className = 'flex-1 p-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all duration-200 text-gray-700';
                        
                        newItemInput.addEventListener('keydown', (event) => {
                            if (event.key === 'Enter') {
                                runCompatibilityCheck();
                            }
                        });
                        inputContainer.insertBefore(newItemInput, document.getElementById('addDeviceBtn'));
                    });
                } else {
                    // Fallback for data attributes
                    itemA.value = e.target.dataset.itemA;
                    itemB.value = e.target.dataset.itemB;
                }
                runCompatibilityCheck(); // Trigger the analysis
            });
        });

        // Listeners for social sharing buttons - ONLY COPY BUTTON REMAINS
        document.getElementById('share-copy').addEventListener('click', () => {
            copyToClipboard(window.location.href);
        });

        // Listeners for accordion functionality in the FAQ section
        document.querySelectorAll('.accordion-button').forEach(button => {
            button.addEventListener('click', () => {
                const accordionContent = button.nextElementSibling;
                const icon = button.querySelector('.accordion-icon');
                
                // Close other open accordions
                document.querySelectorAll('.accordion-content.active').forEach(content => {
                    if (content !== accordionContent) {
                        content.classList.remove('active');
                        content.previousElementSibling.querySelector('.accordion-icon').classList.remove('ph-minus');
                        content.previousElementSibling.querySelector('.accordion-icon').classList.add('ph-plus');
                    }
                });

                // Toggle the clicked accordion
                accordionContent.classList.toggle('active');
                icon.classList.toggle('ph-plus');
                icon.classList.toggle('ph-minus');
            });
        });

        // Initial page load state
        showPage('home-page');
    </script>
</body>
</html>

